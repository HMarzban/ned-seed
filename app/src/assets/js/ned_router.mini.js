(function(a,b){'object'==typeof exports&&'undefined'!=typeof module?module.exports=b():'function'==typeof define&&define.amd?define(b):a.Ned=b()})(this,function(){function a(q,r,s,t){if(t=void 0==t,t)for(;q.lastChild;)q.removeChild(q.lastChild);s=s?s:'afterbegin',q.insertAdjacentHTML(s,r)}function b(q){0==q.indexOf('./')&&(q=q.substring(2));let r=location.pathname.split('/').length;if(2<r)for(let s=0;s<r-2;s++)q='../'+q;return q}function c(){let q=setTimeout(';');for(let r=0;r<q;r++)clearTimeout(r)}function d(q){return'object'==typeof q&&null!==q||'function'==typeof q}function f(q,r,s){let t=new XMLHttpRequest;t.onreadystatechange=function(){4==this.readyState&&200==this.status&&s(this.responseText)},t.open(q,r,!0),t.send()}let h={module:{},components:{},routes:{}},j={},k={modules:{},components:{}},l={},m={},n={},o={customAttributeNavigate:'ned-href',root:'app-root',defualtRoot:'/'};let p={events:{},on:function(q,r){this.events[q]=this.events[q]||[],this.events[q].push(r)},off:function(q,r){if(this.events[q])for(var s=0;s<this.events[q].length;s++)if(this.events[q][s]===r){this.events[q].splice(s,1);break}},emit:function(q,r){this.events[q]&&this.events[q].forEach(function(s){s(r)})}};return function(){async function r(M,N){if(l[M]===void 0)throw new Error('Router \''+M+'\' not defind.');let O=!0;l[M].guard!==void 0&&(O=await l[M].guard());let P=history.state?history.state.path:'/';if(O){let Q=l[M].name?l[M].name:M.replace('/','').replace(/[\/]/g,'-'),R={lastPath:P,path:M,name:Q,location:G+M,domain:location.origin},S=l[M].name,T=M;N?history.replaceState(R,S,T):history.pushState(R,S,T),v(M)}else{let Q={message:`[NED Guard]: You don't have permission to access this route`,path:M};l[M].controller(Q)}}function s(M){if(!l[M].name)throw new Error(`[Ned Warning]: You have to chose name for your "${M}" rout`);return'/'==M?l[M].name?l[M].name.replace(/\s/g,''):M.replace('/','').replace(/[\/]/g,'-'):M.replace('/','').replace(/[\/]/g,'-')}function t(M){var N=history.state.path;let O={};return'component'==M?O={info:l[N],state:history.state,module:{add:y,init:B},reload:x,pubsub:p}:'module'==M&&(O={state:history.state,module:{add:y,init:B},pubsub:p}),O}function v(M){if(c(),l[M].html)f('GET',b(l[M].html),function(N){let O=document.querySelector(o.root),P=s(M),Q=s(history.state.lastPath);if($(O).html(''),O.removeAttribute(Q),a(O,N),O.setAttribute(P,''),l[M].script&&!j[l[M].script]){let R=document.createElement('script');R.src=b(l[M].script),O.appendChild(R),j[l[M].script]=!0}else l[M].script&&h.routes[M][0]();l[M].style&&a(O,'<link rel=\'stylesheet\' type=\'text/css\'  href=\''+b(l[M].style)+'\' />','beforeend',!1),l[M].controller&&l[M].controller.bind(t('component'))()});else throw new Error('HTML Does not defind.')}function w(){if(o.customAttributeNavigate){let O=document.body;O.addEventListener('click',function(P){if('a'==P.target.tagName.toLowerCase()&&null!=P.target.getAttribute(o.customAttributeNavigate)){P.preventDefault();let Q=P.target.getAttribute('href');r(Q)}},!1)}let M;M=l[location.pathname]?location.pathname==o.defualtRoot?o.defualtRoot:location.pathname:o.defualtRoot,r(M)}function x(){v(this.state.path)}function y(M){let N=history.state.path;n[N]==void 0&&(n[N]=[],n[N].push(M))}function z(M,N){let O=history.state.path;if(N.html)f('GET',b(N.html),function(P){let Q=document.querySelectorAll(N.tag),R=document.querySelector(o.root);if(Q.forEach(function(S,T){let U={pubsub:p};U.element=S,S.controller=function(V){V.bind(Object.assign(U))()},a(S,P),S.setAttribute(`${N.tag}_${T+1}`,'')}),N.script&&!k.modules[O]){let S=document.createElement('script');S.src=b(N.script),S.id='script_'+N.tag,R.appendChild(S),k.modules[O]=!0}else h.module[O]();N.style&&a(R,'<link id=\'style_'+N.tag+'\'  rel=\'stylesheet\' type=\'text/css\'  href=\''+b(N.style)+'\' />','beforeend',!1),N.controller&&N.controller()});else throw new Error('HTML Does not defind.')}function A(){var M=history.state.path;n[M].forEach(function(N){z(M,N)})}function B(){A()}function D(){let M=Object.keys(m);for(let N=0;N<M.length;N++)E(M[N])}function E(M){if(m[M].html)f('GET',b(m[M].html),function(N){let O=document.querySelector(M);if(a(O,N),m[M].style&&a(O,'<link rel=\'stylesheet\' type=\'text/css\' href=\''+b(m[M].style)+'\' />','beforeend',!1),m[M].script){let P=document.createElement('script');P.src=b(m[M].script),O.appendChild(P)}m[M].controller&&m[M].controller()});else throw new Error('HTML Does not defind.')}let G,H=location.pathname.split('/').length;G=2<H?location.pathname:location.pathname.substring(0,location.pathname.lastIndexOf('/')),'function'!=typeof Object.assign&&Object.defineProperty(Object,'assign',{value:function(N){'use strict';if(null==N)throw new TypeError('Cannot convert undefined or null to object');let P=Object(N);for(let R,Q=1;Q<arguments.length;Q++)if(R=arguments[Q],null!=R)for(let S in R)Object.prototype.hasOwnProperty.call(R,S)&&(P[S]=R[S]);return P},writable:!0,configurable:!0});window.onpopstate=async function(M){if(M.state){let N=M.state.path;r(N,!0)}};return Object.freeze({router:{add:function(M,N){if(d(M)){let O=Object.keys(M);for(let P=0;P<O.length;P++)l[O[P]]=M[O[P]]}else l[M]=N},controller:function(M){let N=history.state.path,O=t('component');h.routes[N]||(h.routes[N]=[]),h.routes[N].push(M.bind(O)),M.bind(O)()}},component:{add:function(M,N){if(d(M)){let O=Object.keys(M);for(let P=0;P<O.length;P++)m[O[P]]=M[O[P]]}else m[M]=N},controller:function(M){let N=history.state.path,O=t('component');h.components[N]||(h.components[N]=[]),h.components[N].push(M.bind(O)),M.bind(O)()}},module:{add:y,controller:function(M){let N=history.state.path,O=t('module');if(n[N]!=void 0&&!h.module[N])h.module[N]=M.bind(O),h.module[N]();else throw new Error('Controller Name does not find/defind.')}},config:function(M){o.root=M.root?M.root:'app-root',o.defualtRoot=M.defualtRoot?M.defualtRoot:'/',o.customAttributeNavigate=M.customAttributeNavigate?M.customAttributeNavigate:'ned-href'},init:function(){l[o.defualtRoot]&&w(),D()},pubsub:p})}});